(this["webpackJsonpxkcd-viewer"]=this["webpackJsonpxkcd-viewer"]||[]).push([[0],[,,,,,function(e,t,n){e.exports={detailContainer:"detail_view_detailContainer__1n871",header:"detail_view_header__1yy8b",footer:"detail_view_footer__15AZ1",imgContainer:"detail_view_imgContainer__36CRS",img:"detail_view_img__EDs6R",nav:"detail_view_nav__3ZxCL",left:"detail_view_left__1vghy",right:"detail_view_right__2oH8f"}},,function(e,t,n){e.exports={container:"preview_container__3tyz3",comicLabel:"preview_comicLabel__2qlCh",thumbnail:"preview_thumbnail__PGGfu",throbber:"preview_throbber__3alol"}},function(e,t,n){e.exports={container:"navigator_container__3K_-l",monthControls:"navigator_monthControls__MfA8c",chevron:"navigator_chevron__3KyBX",left:"navigator_left__3q30m",right:"navigator_right__2yV4y",star:"navigator_star__C3ecu"}},,,,,function(e,t,n){e.exports={header:"header_header__3STXK",number:"header_number__pOrbt",title:"header_title__3K53V",starButton:"header_starButton__399XM"}},,,function(e,t,n){e.exports={container:"error-view_container__Ew58w",errorItem:"error-view_errorItem__37iuF"}},function(e,t,n){e.exports={background:"popover_background__217Kq",content:"popover_content__iScld"}},function(e,t,n){e.exports={links:"footer_links__27k-1",altContainer:"footer_altContainer__r4MC5"}},,,,,,,function(e,t,n){e.exports={image:"thumbnail_image__2JMsh"}},function(e,t,n){e.exports={container:"throbber_container__12-ci","throbber-bars":"throbber_throbber-bars___fcy3"}},function(e,t,n){e.exports={star:"star_star__3FUks"}},,function(e,t,n){e.exports={button:"month-selector-button_button__2XkCV"}},function(e,t,n){e.exports={container:"overview_container__NObvQ"}},function(e,t,n){e.exports={container:"App_container__290cr"}},,,,,,,,function(e,t,n){},,,,,,,,,function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r,a=n(0),c=n(1),o=n.n(c),i=n(20),s=n.n(i),u=(n(39),n(6)),l=n.n(u),f=n(10),d=n(14),m=n(2),b=n(32),v=n(33),h=n(21),j=n.n(h),g=function(e){return"https://cors-anywhere.herokuapp.com/"+function(e){return"https://xkcd.com/".concat(e?"".concat(e,"/"):"","info.0.json")}(e)},O=function(e){var t=JSON.parse(e),n=t.year,r=t.month,a=t.day,c=t.num,o=Object(v.a)(t,["year","month","day","num"]);return Object(b.a)({date:new Date(Number(n),Number(r)-1,Number(a)),number:c},o)},p=function(){var e=Object(f.a)(l.a.mark((function e(t){var n,r,a,c,o,i,s=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.length>1&&void 0!==s[1]&&s[1],!(void 0!==t&&t<=0)){e.next=3;break}throw new Error("Could not get comic with id ".concat(t,"."));case 3:if(r=g(t),!t){e.next=8;break}if(!(a=localStorage.getItem(r))){e.next=8;break}return e.abrupt("return",O(a));case 8:return e.next=10,j()(r);case 10:if((c=e.sent).ok){e.next=14;break}throw console.error("Could get comic ",r),new Error("Comic info could not be gotten. "+c.statusText);case 14:return e.next=16,c.text();case 16:return o=e.sent,localStorage.setItem(r,o),i=O(o),n&&_(i.img),e.abrupt("return",i);case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(e){return new Promise((function(t,n){var r=new Image;r.addEventListener("load",(function(){return t()})),r.addEventListener("error",(function(e){var t=e.message;return n(t)})),r.src=e}))};function x(e){return"object"===typeof e&&null!==e&&"number"===typeof e.year&&"number"===typeof e.month}function k(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;return x(e)&&x(t)?{from:e,to:t}:{from:y(e),to:y(t)}}function w(e,t){return"object"==typeof(n=e)&&null!=n&&x(n.from)&&x(n.to)?w(e.from,e.to):e.year!==t.year?Math.sign(e.year-t.year):Math.sign(e.month-t.month);var n}function y(e){return{year:e.getFullYear(),month:e.getMonth()+1}}function C(e){var t=e.year,n=e.month,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return r?new Date(t,n,1,0,0,0,-1):new Date(t,n-1)}function N(e){var t=e.year,n=e.month,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=12*t+(n-1)+r;return{month:1+a%12,year:Math.floor(a/12)}}function I(e){var t=e.from,n=e.to,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return{from:N(t,r),to:N(n,r)}}var S="xkcd-favourites",F=JSON.parse(null!==(r=localStorage.getItem(S))&&void 0!==r?r:"[]");function E(e){return F.includes(e)}function R(e){F.includes(e)||(F.push(e),localStorage.setItem(S,JSON.stringify(F)))}function M(e){var t=F.findIndex((function(t){return t===e}));-1!==t&&(F.splice(t,1),localStorage.setItem(S,JSON.stringify(F)))}var D=n(22),L=n(23),T=n(24),A=n(4),J=n(12),P=n(16),q=n.n(P);function B(e){var t=e.queue,n=Object(c.useState)(t.getAllItems()),r=Object(m.a)(n,2),o=r[0],i=r[1];return Object(c.useEffect)((function(){var e=function(e){i(e)};return t.addListener(e),function(){return t.removeListener(e)}}),[i,t]),Object(a.jsx)("div",{className:q.a.container,children:o.map((function(e){var n=e.message,r=e.id;return Object(a.jsxs)("span",{className:q.a.errorItem,children:[n,Object(a.jsx)("button",{value:"x",onClick:function(){t.removeItem(r)},children:"x"})]},r)}))})}var K=Object(J.a)("queue"),V=Object(J.a)("idCounter"),X=Object(J.a)("listeners"),z=Object(J.a)("notifyListeners"),H=function(){function e(){var t=this;Object(L.a)(this,e),Object.defineProperty(this,K,{writable:!0,value:[]}),Object.defineProperty(this,V,{writable:!0,value:0}),Object.defineProperty(this,X,{writable:!0,value:[]}),this.removeItem=function(e){var n=Object(A.a)(t,K)[K].findIndex((function(t){return t.id===e}));n<0||(Object(A.a)(t,K)[K].splice(n,1),Object(A.a)(t,z)[z]())},Object.defineProperty(this,z,{writable:!0,value:function(){var e,n=Object(D.a)(Object(A.a)(t,X)[X]);try{for(n.s();!(e=n.n()).done;){(0,e.value)(t.getAllItems())}}catch(r){n.e(r)}finally{n.f()}}})}return Object(T.a)(e,[{key:"addItem",value:function(e){var t=this,n=Object(A.a)(this,V)[V]++;if("string"===typeof e)return Object(A.a)(this,K)[K].push({id:n,message:e}),void Object(A.a)(this,z)[z]();Object(A.a)(this,K)[K].push({id:n,message:e.message}),"infinite"!==e.timeout&&setTimeout((function(){t.removeItem(n)}),e.timeout)}},{key:"getAllItems",value:function(){return Object(A.a)(this,K)[K].map((function(e){return{id:e.id,message:e.message}}))}},{key:"addListener",value:function(e){Object(A.a)(this,X)[X].push(e)}},{key:"removeListener",value:function(e){var t=Object(A.a)(this,X)[X].indexOf(e);t<0||Object(A.a)(this,X)[X].splice(t,1)}}]),e}(),Q=n(3),U=n.n(Q),G=n(25),Z=n.n(G),Y=function(e){var t=e.comicInfo,n=t.img,r=t.title,c=e.className,o=e.onClick;return Object(a.jsx)("img",{onClick:o,src:n,alt:r,title:r,className:U()(Z.a.image,c)})},W=n(26),$=n.n(W),ee=function(e){var t=e.color,n=e.className;return Object(a.jsxs)("div",{className:U()($.a.container,n),children:[Object(a.jsx)("div",{style:{background:t}}),Object(a.jsx)("div",{style:{background:t}}),Object(a.jsx)("div",{style:{background:t}})]})},te=n(7),ne=n.n(te),re=n.p+"static/media/full_star.7bef184c.svg",ae=n.p+"static/media/empty_star.51ac6047.svg",ce=n(27),oe=n.n(ce),ie=new Map([[!0,{src:re,description:"Full star"}],[!1,{src:ae,description:"Empty star"}]]);function se(e){var t,n,r=e.filled,c=e.size,o=void 0===c?20:c,i=e.onClick,s=e.className;return Object(a.jsx)("img",{className:U()(oe.a.star,s),src:null===(t=ie.get(r))||void 0===t?void 0:t.src,alt:null===(n=ie.get(r))||void 0===n?void 0:n.description,width:o,height:o,onClick:i})}var ue=function(e){var t=e.info,n=e.onOpenComic,r=Object(c.useState)(),o=Object(m.a)(r,2),i=o[0],s=o[1],u=Object(c.useState)(!1),l=Object(m.a)(u,2),f=l[0],d=l[1];return Object(c.useEffect)((function(){t.then((function(e){s(e),d(E(e.number))}))}),[t]),i?Object(a.jsxs)("div",{className:ne.a.container,children:[Object(a.jsxs)("span",{className:ne.a.comicLabel,children:[i.title,Object(a.jsx)(se,{filled:f,onClick:function(){(f?M:R)(i.number),d(!f)}})]}),Object(a.jsx)(Y,{className:ne.a.thumbnail,comicInfo:i,onClick:function(){return n&&n(i.number)}})]}):Object(a.jsxs)("div",{className:ne.a.container+" "+ne.a.throbber,children:[Object(a.jsx)("span",{className:ne.a.comicLabel,children:"loading..."}),Object(a.jsx)(ee,{color:"hsla(0, 0%, 0%, 0.2)",className:ne.a.thumbnail})]})},le=n(28),fe=n.n(le),de=(n(47),n(48),n(29)),me=n.n(de);function be(e){var t=e.onOpen,n=e.dateRange,r=0===w(n)?ve(n.from):function(e){var t=e.from,n=e.to;return"From: ".concat(ve(t)," \u2014 To: ").concat(ve(n))}(n);return Object(a.jsx)("span",{className:me.a.button,onClick:t,children:r})}function ve(e){var t=e.month,n=e.year;return"".concat(he[t-1]," ").concat(n)}var he=["January","February","March","April","May","June","July","August","September","October","November","December"],je=0;var ge=function(e){var t=e.dateRange,n=e.onChangeMonth,r=e.validDateRange,o=r.from,i=r.to,s=Object(c.useRef)();return Object(a.jsx)(fe.a,{age:je++,ref:s,value:0===w(t)?t.from:t,lang:he.map((function(e){return e.slice(0,3)})),years:{min:o,max:i},autoRange:1,onDismiss:function(e){x(e)?n(e,e):n(e.from,e.to)},children:Object(a.jsx)(be,{onOpen:function(){var e;return null===(e=s.current)||void 0===e?void 0:e.show()},dateRange:t})})},Oe=n.p+"static/media/chevron.78647bbb.svg",pe=n(8),_e=n.n(pe),xe=function(e){var t=e.setMonthRange,n=e.onToggleViewFavourites,r=e.dateRange,c=e.validDateRange,o=e.viewingFavourites,i=void 0!==o&&o;return Object(a.jsxs)("div",{className:_e.a.container,children:[Object(a.jsxs)("div",{className:_e.a.monthControls,children:[Object(a.jsx)("img",{src:Oe,className:U()(_e.a.chevron,_e.a.left),onClick:function(){return t(I(r,-1))},alt:"one month earlier"}),Object(a.jsx)(ge,{onChangeMonth:function(e,n){return t(k(e,n))},dateRange:r,validDateRange:c}),Object(a.jsx)("img",{src:Oe,className:U()(_e.a.chevron,_e.a.right),onClick:function(){return t(I(r,1))},alt:"one month later"})]}),Object(a.jsx)(se,{onClick:n,filled:i,size:30,className:_e.a.star})]})},ke=n(30),we=n.n(ke),ye=function(e){var t=e.dateRange,n=e.comics,r=e.onOpenComic,c=e.onUpdateDateRange,o=e.onToggleFavourites,i=e.validDateRange,s=e.viewingFavourites;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("div",{className:we.a.container,children:[0===n.length?"loading...":"",n.map((function(e){var t=Object(m.a)(e,2),n=t[0],c=t[1];return Object(a.jsx)(ue,{info:c,onOpenComic:r},n)}))]}),Object(a.jsx)(xe,{viewingFavourites:s,dateRange:t,onToggleViewFavourites:function(){return o&&o()},setMonthRange:function(e){return c&&c(e)},validDateRange:i})]})},Ce=n(17),Ne=n.n(Ce);function Ie(e){var t=e.open,n=void 0!==t&&t,r=e.onDismiss,o=e.children,i=Object(c.useRef)(null);return Object(c.useEffect)((function(){if(r){var e=function(e){var t;(null===(t=i.current)||void 0===t?void 0:t.contains(e.target))||r()};return window.addEventListener("click",e),function(){window.removeEventListener("click",e)}}}),[r]),n?Object(a.jsx)("div",{className:Ne.a.background,children:Object(a.jsxs)("div",{ref:i,className:Ne.a.content,children:[o," "]})}):null}var Se=n(13),Fe=n.n(Se);function Ee(e){var t=e.number,n=e.title,r=e.isFavourite,c=void 0!==r&&r,o=e.onToggleFavourite,i=e.className,s=void 0===i?"":i;return Object(a.jsxs)("span",{className:U()(s,Fe.a.header),children:[Object(a.jsx)("span",{className:Fe.a.number,children:t}),Object(a.jsx)("span",{className:Fe.a.title,children:n}),Object(a.jsx)(se,{onClick:o,filled:c,className:Fe.a.starButton})]})}var Re=n(18),Me=n.n(Re);function De(e){var t=e.comicInfo,n=e.className,r=void 0===n?"":n;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("div",{className:U()(Me.a.links,r),children:[Object(a.jsx)("a",{href:Le(t.number),target:"blank_",rel:"noopener noreferrer",children:"Source"}),Object(a.jsx)("a",{href:Te(t.number),target:"blank_",rel:"noopener noreferrer",children:"Explaination"})]}),Object(a.jsx)("blockquote",{className:Me.a.altContainer,children:t.alt})]})}var Le=function(e){return"https://xkcd/com/".concat(e)},Te=function(e){return"https://explainxkcd.com/wiki/index.php/".concat(e)},Ae=n(5),Je=n.n(Ae),Pe=function(e){var t=e.number,n=e.previousComic,r=e.nextComic,o=e.goBackHome,i=e.errorQueue,s=Object(c.useState)(null),u=Object(m.a)(s,2),l=u[0],f=u[1],d=Object(c.useState)(!0),b=Object(m.a)(d,2),v=(b[0],b[1]),h=E(t);return Object(c.useEffect)((function(){p(t).then(f).catch((function(e){return i.addItem("Could not get information for this comic. [".concat(e.message,"]"))}))}),[t,i]),Object(c.useEffect)((function(){var e=function(e){"ArrowLeft"===e.key&&n&&n(),"ArrowRight"===e.key&&r&&r(),"Escape"===e.key&&o&&o()};return window.addEventListener("keydown",e),function(){return window.removeEventListener("keydown",e)}}),[n,r,o]),l?Object(a.jsx)(Ie,{open:!0,onDismiss:o,children:Object(a.jsxs)("div",{className:Je.a.detailContainer,children:[Object(a.jsx)(Ee,{number:l.number,title:l.title,isFavourite:h,onToggleFavourite:function(){(h?M:R)(t),v((function(e){return!e}))},className:Je.a.header}),Object(a.jsxs)("div",{className:Je.a.imgContainer,children:[Object(a.jsx)("div",{className:U()(Je.a.left,Je.a.nav),onClick:n}),Object(a.jsx)("img",{className:Je.a.img,src:l.img,alt:l.title,title:l.alt}),Object(a.jsx)("div",{className:U()(Je.a.right,Je.a.nav),onClick:r})]}),Object(a.jsx)(De,{comicInfo:l,className:Je.a.footer})]})}):Object(a.jsx)("div",{children:'"... loading comic."'})},qe=n(31),Be=n.n(qe),Ke=new H;var Ve=function(){var e=Object(c.useState)(k()),t=Object(m.a)(e,2),n=t[0],r=t[1],o=Object(c.useState)(),i=Object(m.a)(o,2),s=i[0],u=i[1],l=Object(c.useState)(),f=Object(m.a)(l,2),b=f[0],v=f[1],h=Object(c.useState)(null),j=Object(m.a)(h,2),g=j[0],O=j[1],x=Object(c.useState)([]),C=Object(m.a)(x,2),I=C[0],S=C[1],E=Object(c.useState)(!1),R=Object(m.a)(E,2),M=R[0],D=R[1];return Object(c.useEffect)((function(){p().then((function(e){return u(e)})).catch((function(e){return Ke.addItem("Cannot load comic. [".concat(e.message,"]"))})),p(1).then((function(e){return v(e)})).catch((function(e){return Ke.addItem("Cannot load latest comic. [".concat(e.message,"]"))}))}),[]),Object(c.useEffect)((function(){if(s)if(M){var e=Object(d.a)(F).map((function(e){return[e,p(e)]})).sort((function(e,t){return Object(m.a)(e,1)[0]-Object(m.a)(t,1)[0]}));S(e)}else(function(e){return Xe.apply(this,arguments)})(n).then((function(e){S(Qe.apply(void 0,Object(d.a)(e)).map((function(e){return[e,p(e)]})))})).catch((function(e){Ke.addItem("Couldn't get all the comics in this date range. [".concat(e.message,"]"))}))}),[n,s,S,M]),Object(c.useEffect)((function(){var e;g&&(g+1<=(null!==(e=null===s||void 0===s?void 0:s.number)&&void 0!==e?e:0)&&p(g+1).then((function(e){var t=e.img;return _(t)})).catch((function(e){return Ke.addItem("Could not preload next image. [".concat(e.message,"]"))})),g-1>=1&&p(g-1).then((function(e){var t=e.img;return _(t)})).catch((function(e){return Ke.addItem("Could not preload previous image. [".concat(e.message,"]"))})))}),[g,s]),Object(c.useEffect)((function(){g&&!M&&p(g).then((function(e){var t=y(e.date);w(t,n.from)<0&&r((function(e){return k(N(e.from,-1),e.to)})),w(t,n.to)>0&&r((function(e){return k(e.from,N(e.to,1))}))})).catch((function(e){Ke.addItem("Encountered an error updating this page. [".concat(e.message,"]"))}))}),[g,n,r,M]),s&&b?Object(a.jsxs)("div",{className:Be.a.container,children:[Object(a.jsx)(B,{queue:Ke}),Object(a.jsx)(ye,{comics:I,onOpenComic:O,dateRange:n,validDateRange:k(b.date,s.date),onUpdateDateRange:function(e){r(e),S([])},viewingFavourites:M,onToggleFavourites:function(){D((function(e){return!e}))}}),g&&Object(a.jsx)(Pe,{number:g,nextComic:function(){return O((function(e){return Math.min(s.number,(null!==e&&void 0!==e?e:0)+1)}))},previousComic:function(){return O((function(e){return Math.max(1,(null!==e&&void 0!==e?e:0)-1)}))},goBackHome:function(){return O(null)},errorQueue:Ke})]}):Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(B,{queue:Ke}),"...loading"]})};function Xe(){return(Xe=Object(f.a)(l.a.mark((function e(t){var n,r,a,c,o,i,s,u,f,d,b,v,h,j,g,O,_,x,k;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.from,r=t.to,1,e.next=4,Promise.all([p(1),p()]);case 4:return a=e.sent,c=Object(m.a)(a,2),o=c[0].date,i=c[1],s=i.date,u=i.number,f=y(o),d=12*f.year+f.month,b=y(s),v=12*b.year+b.month,h=v-d,j=12*n.year+n.month,g=12*r.year+r.month,O=(j-d)/h,_=(g-d)/h,x=Ue(Math.round(O*u),1,u),k=Ue(Math.round(_*u),1,u),e.abrupt("return",Promise.all([ze(n,x,u,!1),ze(r,k,u,!0)]));case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ze(e,t,n){return He.apply(this,arguments)}function He(){return(He=Object(f.a)(l.a.mark((function e(t,n,r){var a,c,o,i=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=i.length>3&&void 0!==i[3]&&i[3],c=C(t,a),o=Ue(n%2?n:n+1,1,r);case 3:return e.next=5,p(o);case 5:if(e.t0=e.sent.date,e.t1=c,!(e.t0>e.t1)){e.next=13;break}if(1!==o){e.next=10;break}return e.abrupt("break",13);case 10:o-=2,e.next=3;break;case 13:return e.next=15,p(o);case 15:if(e.t2=e.sent.date,e.t3=c,!(e.t2<e.t3)){e.next=23;break}if(o!==r){e.next=20;break}return e.abrupt("return",r);case 20:o++,e.next=13;break;case 23:return e.abrupt("return",o+(a?-1:0));case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qe(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=[],r=e;r<=t;r++)n.push(r);return n}function Ue(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(e,t),n)}var Ge=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,50)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),c(e),o(e)}))};s.a.render(Object(a.jsx)(o.a.StrictMode,{children:Object(a.jsx)(Ve,{})}),document.getElementById("root")),Ge()}],[[49,1,2]]]);
//# sourceMappingURL=main.a596a3bc.chunk.js.map